<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Home · Ignite.jl</title><meta name="title" content="Home · Ignite.jl"/><meta property="og:title" content="Home · Ignite.jl"/><meta property="twitter:title" content="Home · Ignite.jl"/><meta name="description" content="Documentation for Ignite.jl."/><meta property="og:description" content="Documentation for Ignite.jl."/><meta property="twitter:description" content="Documentation for Ignite.jl."/><meta property="og:url" content="https://jondeuce.github.io/Ignite.jl/"/><meta property="twitter:url" content="https://jondeuce.github.io/Ignite.jl/"/><link rel="canonical" href="https://jondeuce.github.io/Ignite.jl/"/><script data-outdated-warner src="assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="search_index.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href>Ignite.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li class="is-active"><a class="tocitem" href>Home</a><ul class="internal"><li><a class="tocitem" href="#docstrings"><span>Docstrings</span></a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Home</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Home</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/jondeuce/Ignite.jl/blob/master/docs/src/index.md#" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Ignite.jl"><a class="docs-heading-anchor" href="#Ignite.jl">Ignite.jl</a><a id="Ignite.jl-1"></a><a class="docs-heading-anchor-permalink" href="#Ignite.jl" title="Permalink"></a></h1><p>Documentation for <a href="https://github.com/jondeuce/Ignite.jl">Ignite.jl</a>.</p><h2 id="docstrings"><a class="docs-heading-anchor" href="#docstrings">Docstrings</a><a id="docstrings-1"></a><a class="docs-heading-anchor-permalink" href="#docstrings" title="Permalink"></a></h2><ul><li><a href="#Ignite.Ignite"><code>Ignite.Ignite</code></a></li><li><a href="#Ignite.AbstractEvent"><code>Ignite.AbstractEvent</code></a></li><li><a href="#Ignite.AbstractFiringEvent"><code>Ignite.AbstractFiringEvent</code></a></li><li><a href="#Ignite.AbstractLoopEvent"><code>Ignite.AbstractLoopEvent</code></a></li><li><a href="#Ignite.AndEvent"><code>Ignite.AndEvent</code></a></li><li><a href="#Ignite.Engine"><code>Ignite.Engine</code></a></li><li><a href="#Ignite.EventHandler"><code>Ignite.EventHandler</code></a></li><li><a href="#Ignite.FilteredEvent"><code>Ignite.FilteredEvent</code></a></li><li><a href="#Ignite.OrEvent"><code>Ignite.OrEvent</code></a></li><li><a href="#Ignite.State"><code>Ignite.State</code></a></li><li><a href="#Ignite.add_event_handler!-Tuple{Any, Engine, AbstractEvent, Vararg{Any, N} where N}"><code>Ignite.add_event_handler!</code></a></li><li><a href="#Ignite.every_filter-Tuple{Union{Int64, AbstractVector{Int64}}}"><code>Ignite.every_filter</code></a></li><li><a href="#Ignite.filter_event-Tuple{AbstractFiringEvent}"><code>Ignite.filter_event</code></a></li><li><a href="#Ignite.fire_event!-Tuple{Engine, AbstractFiringEvent}"><code>Ignite.fire_event!</code></a></li><li><a href="#Ignite.fire_event_handler!-Tuple{Engine, EventHandler, AbstractFiringEvent}"><code>Ignite.fire_event_handler!</code></a></li><li><a href="#Ignite.once_filter-Tuple{Union{Int64, AbstractVector{Int64}}}"><code>Ignite.once_filter</code></a></li><li><a href="#Ignite.reset!-Tuple{Engine}"><code>Ignite.reset!</code></a></li><li><a href="#Ignite.run!-Tuple{Engine, Any}"><code>Ignite.run!</code></a></li><li><a href="#Ignite.terminate!-Tuple{Engine}"><code>Ignite.terminate!</code></a></li><li><a href="#Ignite.throttle_filter"><code>Ignite.throttle_filter</code></a></li><li><a href="#Ignite.timeout_filter"><code>Ignite.timeout_filter</code></a></li></ul><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Ignite.Ignite" href="#Ignite.Ignite"><code>Ignite.Ignite</code></a> — <span class="docstring-category">Module</span></header><section><div><p><strong>Ignite.jl</strong></p><p><a href="https://jondeuce.github.io/Ignite.jl/dev/"><img src="https://img.shields.io/badge/docs-dev-blue.svg" alt="Dev"/></a> <a href="https://github.com/jondeuce/Ignite.jl/actions/workflows/CI.yml?query=branch%3Amaster"><img src="https://github.com/jondeuce/Ignite.jl/actions/workflows/CI.yml/badge.svg?branch=master" alt="Build Status"/></a> <a href="https://codecov.io/gh/jondeuce/Ignite.jl"><img src="https://codecov.io/gh/jondeuce/Ignite.jl/branch/master/graph/badge.svg" alt="Coverage"/></a> <a href="https://github.com/JuliaTesting/Aqua.jl"><img src="https://raw.githubusercontent.com/JuliaTesting/Aqua.jl/master/badge.svg" alt="Aqua QA"/></a></p><p>Welcome to <code>Ignite.jl</code>, a Julia port of the Python library <a href="https://github.com/pytorch/ignite"><code>ignite</code></a> for simplifying neural network training and validation loops using events and handlers.</p><p><code>Ignite.jl</code> provides a simple yet flexible engine and event system, allowing for the easy composition of training pipelines with various events such as artifact saving, metric logging, and model validation. Event-based training abstracts away the training loop, replacing it with:</p><ol><li>An <em>engine</em> which wraps a <em>process function</em> that consumes a single batch of data,</li><li>An iterable data loader which produces said batches of data, and</li><li>Events and corresponding event handlers which are attached to the engine, configured to fire at specific points during training.</li></ol><p>Event handlers are much more flexibile compared to other approaches like callbacks: handlers can be any callable; multiple handlers can be attached to a single event; multiple events can trigger the same handler; and custom events can be defined to fire at user-specified points during training. This makes adding functionality to your training pipeline easy, minimizing the need to modify existing code.</p><p><strong>Quick Start</strong></p><p>The example below demonstrates how to use <code>Ignite.jl</code> to train a simple neural network. Key features to note:</p><ul><li>The training step is factored out of the training loop: the <code>train_step</code> process function takes a batch of training data and computes the training loss, gradients, and updates the model parameters.</li><li>Data loaders can be any iterable collection. Here, we use a <a href="https://juliaml.github.io/MLUtils.jl/stable/api/#MLUtils.DataLoader"><code>DataLoader</code></a> from <a href="https://github.com/JuliaML/MLUtils.jl"><code>MLUtils.jl</code></a></li></ul><pre><code class="language-julia hljs">using Ignite
using Flux, Zygote, Optimisers, MLUtils # for training a neural network

# Build simple neural network and initialize Adam optimizer
model = Chain(Dense(1 =&gt; 32, tanh), Dense(32 =&gt; 1))
optim = Flux.setup(Optimisers.Adam(1.0f-3), model)

# Create mock data and data loaders
f(x) = 2x - x^3
xtrain, xtest = 2 * rand(Float32, 1, 10_000) .- 1, collect(reshape(range(-1.0f0, 1.0f0; length = 100), 1, :))
ytrain, ytest = f.(xtrain), f.(xtest)
train_data_loader = DataLoader((; x = xtrain, y = ytrain); batchsize = 64, shuffle = true, partial = false)
eval_data_loader = DataLoader((; x = xtest, y = ytest); batchsize = 10, shuffle = false)

# Create training engine:
#   - `engine` is a reference to the parent `trainer` engine, created below
#   - `batch` is a batch of training data, retrieved by iterating `train_data_loader`
#   - (optional) return value is stored in `trainer.state.output`
function train_step(engine, batch)
    x, y = batch
    l, gs = Zygote.withgradient(m -&gt; sum(abs2, m(x) .- y), model)
    Optimisers.update!(optim, model, gs[1])
    return Dict(&quot;loss&quot; =&gt; l)
end
trainer = Engine(train_step)

# Start the training
Ignite.run!(trainer, train_data_loader; max_epochs = 25, epoch_length = 100)</code></pre><p><strong>Periodically evaluate model</strong></p><p>The real power of <code>Ignite.jl</code> comes when adding <em>event handlers</em> to our training engine.</p><p>Let&#39;s evaluate our model after every 5th training epoch. This can be easily incorporated without needing to modify any of the above training code:</p><ol><li>Create an <code>evaluator</code> engine which consumes batches of evaluation data</li><li>Add <em>event handlers</em> to the <code>evaluator</code> engine which accumulate a running average of evaluation metrics over batches of evaluation data; we use <a href="https://github.com/joshday/OnlineStats.jl"><code>OnlineStats.jl</code></a> to make this easy.</li><li>Add an event handler to the <code>trainer</code> which runs the <code>evaluator</code> on the evaluation data loader every 5 training epochs.</li></ol><pre><code class="language-julia hljs">using OnlineStats: Mean, fit!, value # for tracking evaluation metrics

# Create an evaluation engine using `do` syntax:
evaluator = Engine() do engine, batch
    x, y = batch
    ypred = model(x) # evaluate model on a single batch of validation data
    return Dict(&quot;ytrue&quot; =&gt; y, &quot;ypred&quot; =&gt; ypred) # result is stored in `evaluator.state.output`
end

# Add event handlers to the evaluation engine to track metrics:
add_event_handler!(evaluator, STARTED()) do engine
    # When `evaluator` starts, initialize the running mean
    engine.state.metrics = Dict(&quot;abs_err&quot; =&gt; Mean()) # new fields can be added to `engine.state` dynamically
end

add_event_handler!(evaluator, ITERATION_COMPLETED()) do engine
    # Each iteration, compute eval metrics from predictions
    o = engine.state.output
    m = engine.state.metrics[&quot;abs_err&quot;]
    fit!(m, abs.(o[&quot;ytrue&quot;] .- o[&quot;ypred&quot;]) |&gt; vec)
end

# Add an event handler to `trainer` which runs `evaluator` every 5 epochs:
add_event_handler!(trainer, EPOCH_COMPLETED(; every = 5)) do engine
    Ignite.run!(evaluator, eval_data_loader)
    @info &quot;Evaluation metrics: abs_err = $(evaluator.state.metrics[&quot;abs_err&quot;])&quot;
end

# Run the trainer with periodic evaluation
Ignite.run!(trainer, train_data_loader; max_epochs = 25, epoch_length = 100)</code></pre><p><strong>Terminating a run</strong></p><p>There are several ways to stop a training run before it has completed:</p><ol><li>Throw an exception as usual. This will immediately stop training. An <code>EXCEPTION_RAISED()</code> event will be subsequently be fired.</li><li>Use a keyboard interrupt, i.e. throw an <code>InterruptException</code> via <code>Ctrl+C</code> or <code>Cmd+C</code>. Training will halt, and an <code>INTERRUPT()</code> event will be fired.</li><li>Gracefully terminate via <a href="https://jondeuce.github.io/Ignite.jl/dev/#Ignite.terminate!-Tuple{Engine}"><code>Ignite.terminate!(trainer)</code></a>, or equivalently, <code>trainer.should_terminate = true</code>. This will allow the current iteration to finish but no further iterations will begin. Then, a <code>TERMINATE()</code> event will be fired followed by a <code>COMPLETED()</code> event.</li></ol><p><strong>Early stopping</strong></p><p>To implement early stopping, we can add an event handler to <code>trainer</code> which checks the evaluation metrics and gracefully terminates <code>trainer</code> if the metrics fail to improve. To do so, we first define a training termination trigger using <a href="http://fluxml.ai/Flux.jl/stable/training/callbacks/#Flux.early_stopping"><code>Flux.early_stopping</code></a>:</p><pre><code class="language-julia hljs"># Callback which returns `true` if the eval loss fails to decrease by
# at least `min_dist` for two consecutive evaluations
early_stop_trigger = Flux.early_stopping(2; init_score = Inf32, min_dist = 5.0f-3) do
    return value(evaluator.state.metrics[&quot;abs_err&quot;])
end</code></pre><p>Then, we add an event handler to <code>trainer</code> which checks the early stopping trigger and terminates training if the trigger returns <code>true</code>:</p><pre><code class="language-julia hljs"># This handler must fire every 5th epoch, the same as the evaluation event handler,
# to ensure new evaluation metrics are available
add_event_handler!(trainer, EPOCH_COMPLETED(; every = 5)) do engine
    if early_stop_trigger()
        @info &quot;Stopping early&quot;
        Ignite.terminate!(trainer)
    end
end

# Run the trainer with periodic evaluation and early stopping
Ignite.run!(trainer, train_data_loader; max_epochs = 25, epoch_length = 100)</code></pre><p>Note: instead of adding a new event, the evaluation event handler from the previous section could have been modified to check <code>early_stop_trigger()</code> immediately after <code>evaluator</code> is run.</p><p><strong>Artifact saving</strong></p><p>Logging artifacts can be easily added to the trainer, again without modifying the above code. For example, save the current model and optimizer state to disk every 10 epochs using <a href="https://github.com/JuliaIO/JLD2.jl"><code>JLD2.jl</code></a>:</p><pre><code class="language-julia hljs">using JLD2

# Save model and optimizer state every 10 epochs
add_event_handler!(trainer, EPOCH_COMPLETED(; every = 10)) do engine
    model_state = Flux.state(model)
    jldsave(&quot;model_and_optim.jld2&quot;; model_state, optim)
    @info &quot;Saved model and optimizer state to disk&quot;
end</code></pre><p><strong>Trigger multiple functions per event</strong></p><p>Multiple event handlers can be added to the same event:</p><pre><code class="language-julia hljs">add_event_handler!(trainer, COMPLETED()) do engine
    # Runs after training has completed
end
add_event_handler!(trainer, COMPLETED()) do engine
    # Also runs after training has completed, after the above function runs
end</code></pre><p><strong>Attach the same handler to multiple events</strong></p><p>The boolean operators <code>|</code> and <code>&amp;</code> can be used to combine events together:</p><pre><code class="language-julia hljs">add_event_handler!(trainer, EPOCH_COMPLETED(; every = 10) | COMPLETED()) do engine
    # Runs at the end of every 10th epoch, or when training is completed
end

throttled_event = EPOCH_COMPLETED(; every = 3) &amp; EPOCH_COMPLETED(; event_filter = throttle_filter(30.0))
add_event_handler!(trainer, throttled_event) do engine
    # Runs at the end of every 3rd epoch if at least 30s has passed since the last firing
end</code></pre><p><strong>Define custom events</strong></p><p>Custom events can be created and fired at user-defined stages in the training process.</p><p>For example, suppose we want to define events that fire at the start and finish of both the backward pass and the optimizer step. All we need to do is define new event types that subtype <code>AbstractLoopEvent</code>, and then fire them at appropriate points in the <code>train_step</code> process function using <code>fire_event!</code>:</p><pre><code class="language-julia hljs">struct BACKWARD_STARTED &lt;: AbstractLoopEvent end
struct BACKWARD_COMPLETED &lt;: AbstractLoopEvent end
struct OPTIM_STEP_STARTED &lt;: AbstractLoopEvent end
struct OPTIM_STEP_COMPLETED &lt;: AbstractLoopEvent end

function train_step(engine, batch)
    x, y = batch

    # Compute the gradients of the loss with respect to the model
    fire_event!(engine, BACKWARD_STARTED())
    l, gs = Zygote.withgradient(m -&gt; sum(abs2, m(x) .- y), model)
    engine.state.gradients = gs # the engine state can be accessed by event handlers
    fire_event!(engine, BACKWARD_COMPLETED())

    # Update the model&#39;s parameters
    fire_event!(engine, OPTIM_STEP_STARTED())
    Optimisers.update!(optim, model, gs[1])
    fire_event!(engine, OPTIM_STEP_COMPLETED())

    return Dict(&quot;loss&quot; =&gt; l)
end
trainer = Engine(train_step)</code></pre><p>Then, add event handlers for these custom events as usual:</p><pre><code class="language-julia hljs">add_event_handler!(trainer, BACKWARD_COMPLETED(; every = 10)) do engine
    # This code runs after every 10th backward pass is completed
end</code></pre><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jondeuce/Ignite.jl/blob/36313cb3703df9bcd4dc7d46aafe85efb3d7c973/src/Ignite.jl#L1">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Ignite.AbstractEvent" href="#Ignite.AbstractEvent"><code>Ignite.AbstractEvent</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">abstract type AbstractEvent</code></pre><p>Abstract supertype for all events.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jondeuce/Ignite.jl/blob/36313cb3703df9bcd4dc7d46aafe85efb3d7c973/src/Ignite.jl#L18">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Ignite.AbstractFiringEvent" href="#Ignite.AbstractFiringEvent"><code>Ignite.AbstractFiringEvent</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">abstract type AbstractFiringEvent &lt;: AbstractEvent</code></pre><p>Abstract supertype for all events which can trigger event handlers via <a href="#Ignite.fire_event!-Tuple{Engine, AbstractFiringEvent}"><code>fire_event!</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jondeuce/Ignite.jl/blob/36313cb3703df9bcd4dc7d46aafe85efb3d7c973/src/Ignite.jl#L25">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Ignite.AbstractLoopEvent" href="#Ignite.AbstractLoopEvent"><code>Ignite.AbstractLoopEvent</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">abstract type AbstractLoopEvent &lt;: AbstractFiringEvent</code></pre><p>Abstract supertype for events fired during the normal execution of <a href="#Ignite.run!-Tuple{Engine, Any}"><code>Ignite.run!</code></a>.</p><p>A default convenience constructor <code>(EVENT::Type{&lt;:AbstractLoopEvent})(; kwargs...)</code> is provided to allow for easy filtering of <code>AbstractLoopEvent</code>s. For example, <code>EPOCH_COMPLETED(every = 3)</code> will build a <a href="#Ignite.FilteredEvent"><code>FilteredEvent</code></a> which is triggered every third epoch. See <a href="#Ignite.filter_event-Tuple{AbstractFiringEvent}"><code>filter_event</code></a> for allowed keywords.</p><p>By inheriting from <code>AbstractLoopEvent</code>, custom events will inherit these convenience constructors, too. If this is undesired, one can instead inherit from the supertype <code>AbstractFiringEvent</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jondeuce/Ignite.jl/blob/36313cb3703df9bcd4dc7d46aafe85efb3d7c973/src/Ignite.jl#L32">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Ignite.AndEvent" href="#Ignite.AndEvent"><code>Ignite.AndEvent</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">struct AndEvent{E1&lt;:AbstractEvent, E2&lt;:AbstractEvent} &lt;: AbstractEvent</code></pre><p><code>AndEvent(event1, event2)</code> wraps two events and triggers if and only if both wrapped events are triggered by the same firing event firing.</p><p><code>AndEvent</code>s can be constructed via the <code>&amp;</code> operator: <code>event1 &amp; event2</code>.</p><p>Fields: </p><ul><li><p><code>event1::AbstractEvent</code>: The first wrapped event that will be considered for triggering.</p></li><li><p><code>event2::AbstractEvent</code>: The second wrapped event that will be considered for triggering.</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jondeuce/Ignite.jl/blob/36313cb3703df9bcd4dc7d46aafe85efb3d7c973/src/Ignite.jl#L597">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Ignite.Engine" href="#Ignite.Engine"><code>Ignite.Engine</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">mutable struct Engine{P}</code></pre><p>An <code>Engine</code> struct to be run using <a href="#Ignite.run!-Tuple{Engine, Any}"><code>Ignite.run!</code></a>. Can be constructed via <code>engine = Engine(process_function; kwargs...)</code>, where the process function takes two arguments: the parent <code>engine</code>, and a batch of data.</p><p>Fields: </p><ul><li><p><code>process_function::Any</code>: A function that processes a single batch of data and returns an output.</p></li><li><p><code>state::State</code>: An object that holds the current state of the engine.</p></li><li><p><code>event_handlers::Vector{EventHandler}</code>: A list of event handlers that are called at specific points when the engine is running.</p></li><li><p><code>logger::Union{Nothing, Base.CoreLogging.AbstractLogger}</code>: An optional logger; if <code>nothing</code>, then <code>current_logger()</code> will be used.</p></li><li><p><code>timer::TimerOutputs.TimerOutput</code>: Internal timer. Can be used with <code>TimerOutputs</code> to record event timings</p></li><li><p><code>should_terminate::Bool</code>: A flag that indicates whether the engine should stop running.</p></li><li><p><code>exception::Union{Nothing, Exception}</code>: Exception thrown during training</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jondeuce/Ignite.jl/blob/36313cb3703df9bcd4dc7d46aafe85efb3d7c973/src/Ignite.jl#L137">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Ignite.EventHandler" href="#Ignite.EventHandler"><code>Ignite.EventHandler</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">struct EventHandler{E&lt;:AbstractEvent, H, A&lt;:Tuple}</code></pre><p><code>EventHandler</code>s wrap an <code>event</code> and a corresponding <code>handler!</code>. The <code>handler!</code> is executed when <code>event</code> is triggered by a call to <a href="#Ignite.fire_event!-Tuple{Engine, AbstractFiringEvent}"><code>fire_event!</code></a>. The output from <code>handler!</code> is ignored. Additional <code>args</code> for <code>handler!</code> may be stored in <code>EventHandler</code> at construction; see <a href="#Ignite.add_event_handler!-Tuple{Any, Engine, AbstractEvent, Vararg{Any, N} where N}"><code>add_event_handler!</code></a>.</p><p>When <code>h::EventHandler</code> is triggered, the event handler is called as <code>h.handler!(engine::Engine, h.args...)</code>.</p><p>Fields: </p><ul><li><p><code>event::AbstractEvent</code>: Event which triggers handler</p></li><li><p><code>handler!::Any</code>: Event handler which executes when triggered by <code>event</code></p></li><li><p><code>args::Tuple</code>: Additional arguments passed to the event handler</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jondeuce/Ignite.jl/blob/36313cb3703df9bcd4dc7d46aafe85efb3d7c973/src/Ignite.jl#L66">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Ignite.FilteredEvent" href="#Ignite.FilteredEvent"><code>Ignite.FilteredEvent</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">struct FilteredEvent{E&lt;:AbstractEvent, F} &lt;: AbstractEvent</code></pre><p><code>FilteredEvent(event::E, event_filter::F)</code> wraps an <code>event</code> and a <code>event_filter</code> function.</p><p>When a firing event <code>e</code> is fired, if <code>event_filter(engine, e)</code> returns <code>true</code> then the filtered event will be fired too.</p><p>Fields: </p><ul><li><p><code>event::AbstractEvent</code>: The wrapped event that will be fired if the filter function returns true when applied to a firing event.</p></li><li><p><code>event_filter::Any</code>: The filter function <code>(::Engine, ::AbstractFiringEvent) -&gt; Bool</code> returns <code>true</code> if the filtered event should be fired.</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jondeuce/Ignite.jl/blob/36313cb3703df9bcd4dc7d46aafe85efb3d7c973/src/Ignite.jl#L538">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Ignite.OrEvent" href="#Ignite.OrEvent"><code>Ignite.OrEvent</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">struct OrEvent{E1&lt;:AbstractEvent, E2&lt;:AbstractEvent} &lt;: AbstractEvent</code></pre><p><code>OrEvent(event1, event2)</code> wraps two events and triggers if either of the wrapped events are triggered by a firing event firing.</p><p><code>OrEvent</code>s can be constructed via the <code>|</code> operator: <code>event1 | event2</code>.</p><p>Fields: </p><ul><li><p><code>event1::AbstractEvent</code>: The first wrapped event that will be checked if it should be fired.</p></li><li><p><code>event2::AbstractEvent</code>: The second wrapped event that will be checked if it should be fired.</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jondeuce/Ignite.jl/blob/36313cb3703df9bcd4dc7d46aafe85efb3d7c973/src/Ignite.jl#L576">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Ignite.State" href="#Ignite.State"><code>Ignite.State</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">struct State &lt;: AbstractDict{Symbol, Any}</code></pre><p>Current state of the engine.</p><p><code>State</code> is a light wrapper around a <code>DefaultOrderedDict{Symbol, Any, Nothing}</code> with the following keys:</p><ul><li><code>:iteration</code>: the current iteration, beginning with 1.</li><li><code>:epoch</code>: the current epoch, beginning with 1.</li><li><code>:max_epochs</code>: The number of epochs to run.</li><li><code>:epoch_length</code>: The number of batches processed per epoch.</li><li><code>:output</code>: The output of <code>process_function</code> after a single iteration.</li><li><code>:last_event</code>: The last event fired.</li><li><code>:counters</code>: A <code>DefaultOrderedDict{AbstractFiringEvent, Int, Int}(0)</code> with firing event firing counters.</li><li><code>:times</code>: An <code>OrderedDict{AbstractFiringEvent, Float64}()</code> with total and per-epoch times fetched on firing event keys.</li></ul><p>Fields can be accessed and modified using <code>getproperty</code> and <code>setproperty!</code>. For example, <code>engine.state.iteration</code> can be used to access the current iteration, and <code>engine.state.new_field = value</code> can be used to store <code>value</code> for later use e.g. by an event handler.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jondeuce/Ignite.jl/blob/36313cb3703df9bcd4dc7d46aafe85efb3d7c973/src/Ignite.jl#L89">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Ignite.add_event_handler!-Tuple{Any, Engine, AbstractEvent, Vararg{Any, N} where N}" href="#Ignite.add_event_handler!-Tuple{Any, Engine, AbstractEvent, Vararg{Any, N} where N}"><code>Ignite.add_event_handler!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">add_event_handler!(
    handler!,
    engine::Engine,
    event::AbstractEvent,
    handler_args...
) -&gt; Engine
</code></pre><p>Add an event handler to an engine which is fired when <code>event</code> is triggered.</p><p>When fired, the event handler is called as <code>handler!(engine::Engine, handler_args...)</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jondeuce/Ignite.jl/blob/36313cb3703df9bcd4dc7d46aafe85efb3d7c973/src/Ignite.jl#L252-L258">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Ignite.every_filter-Tuple{Union{Int64, AbstractVector{Int64}}}" href="#Ignite.every_filter-Tuple{Union{Int64, AbstractVector{Int64}}}"><code>Ignite.every_filter</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">every_filter(
    every::Union{Int64, AbstractVector{Int64}}
) -&gt; Ignite.EveryFilter{_A} where _A
</code></pre><p>Creates an event filter function for use in a <code>FilteredEvent</code> that returns <code>true</code> periodically depending on <code>every</code>:</p><ul><li>If <code>every = n::Int</code>, the filter will trigger every <code>n</code>th firing of the event.</li><li>If <code>every = Int[n₁, n₂, ...]</code>, the filter will trigger every <code>n₁</code>th firing, every <code>n₂</code>th firing, and so on.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jondeuce/Ignite.jl/blob/36313cb3703df9bcd4dc7d46aafe85efb3d7c973/src/Ignite.jl#L496-L502">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Ignite.filter_event-Tuple{AbstractFiringEvent}" href="#Ignite.filter_event-Tuple{AbstractFiringEvent}"><code>Ignite.filter_event</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Filter the input <code>event</code> to fire conditionally:</p><p>Inputs:</p><ul><li><code>event::AbstractFiringEvent</code>: event to be filtered.</li><li><code>event_filter::Any</code>: A event_filter function <code>(::Engine, ::AbstractFiringEvent) -&gt; Bool</code> returning <code>true</code> if the filtered event should be fired.</li><li><code>every::Union{Int, &lt;:AbstractVector{Int}}</code>: the period(s) in which the filtered event should be fired; see <a href="#Ignite.every_filter-Tuple{Union{Int64, AbstractVector{Int64}}}"><code>every_filter</code></a>.</li><li><code>once::Union{Int, &lt;:AbstractVector{Int}}</code>: the point(s) at which the filtered event should be fired; see <a href="#Ignite.once_filter-Tuple{Union{Int64, AbstractVector{Int64}}}"><code>once_filter</code></a>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jondeuce/Ignite.jl/blob/36313cb3703df9bcd4dc7d46aafe85efb3d7c973/src/Ignite.jl#L555">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Ignite.fire_event!-Tuple{Engine, AbstractFiringEvent}" href="#Ignite.fire_event!-Tuple{Engine, AbstractFiringEvent}"><code>Ignite.fire_event!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">fire_event!(
    engine::Engine,
    e::AbstractFiringEvent
) -&gt; Engine
</code></pre><p>Execute all event handlers triggered by the firing event <code>e</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jondeuce/Ignite.jl/blob/36313cb3703df9bcd4dc7d46aafe85efb3d7c973/src/Ignite.jl#L405-L409">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Ignite.fire_event_handler!-Tuple{Engine, EventHandler, AbstractFiringEvent}" href="#Ignite.fire_event_handler!-Tuple{Engine, EventHandler, AbstractFiringEvent}"><code>Ignite.fire_event_handler!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">fire_event_handler!(
    engine::Engine,
    event_handler!::EventHandler,
    e::AbstractFiringEvent
) -&gt; Engine
</code></pre><p>Execute <code>event_handler!</code> if it is triggered by the firing event <code>e</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jondeuce/Ignite.jl/blob/36313cb3703df9bcd4dc7d46aafe85efb3d7c973/src/Ignite.jl#L441-L445">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Ignite.once_filter-Tuple{Union{Int64, AbstractVector{Int64}}}" href="#Ignite.once_filter-Tuple{Union{Int64, AbstractVector{Int64}}}"><code>Ignite.once_filter</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">once_filter(
    once::Union{Int64, AbstractVector{Int64}}
) -&gt; Ignite.OnceFilter{_A} where _A
</code></pre><p>Creates an event filter function for use in a <code>FilteredEvent</code> that returns <code>true</code> at specific points depending on <code>once</code>:</p><ul><li>If <code>once = n::Int</code>, the filter will trigger only on the <code>n</code>th firing of the event.</li><li>If <code>once = Int[n₁, n₂, ...]</code>, the filter will trigger only on the <code>n₁</code>th firing, the <code>n₂</code>th firing, and so on.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jondeuce/Ignite.jl/blob/36313cb3703df9bcd4dc7d46aafe85efb3d7c973/src/Ignite.jl#L505-L511">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Ignite.reset!-Tuple{Engine}" href="#Ignite.reset!-Tuple{Engine}"><code>Ignite.reset!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">reset!(engine::Engine) -&gt; Engine
</code></pre><p>Reset the engine state.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jondeuce/Ignite.jl/blob/36313cb3703df9bcd4dc7d46aafe85efb3d7c973/src/Ignite.jl#L232-L236">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Ignite.run!-Tuple{Engine, Any}" href="#Ignite.run!-Tuple{Engine, Any}"><code>Ignite.run!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">run!(
    engine::Engine,
    dataloader;
    max_epochs,
    epoch_length
) -&gt; Any
</code></pre><p>Run the <code>engine</code>. Data batches are retrieved by iterating <code>dataloader</code>. The data loader may be infinite; by default, it is restarted if it empties.</p><p>Inputs:</p><ul><li><code>engine::Engine</code>: An instance of the <code>Engine</code> struct containing the <code>process_function</code> to run each iteration.</li><li><code>dataloader</code>: A data loader to iterate over.</li><li><code>max_epochs::Int</code>: the number of epochs to run. Defaults to 1.</li><li><code>epoch_length::Int</code>: the length of an epoch. If <code>nothing</code>, falls back to <code>length(dataloader)</code>.</li></ul><p>Conceptually, running the engine is roughly equivalent to the following:</p><ol><li>The engine state is initialized.</li><li>The engine begins running for <code>max_epochs</code> epochs, or until <code>engine.should_terminate == true</code>.</li><li>At the start of each epoch, <code>EPOCH_STARTED()</code> event is fired.</li><li>An iteration loop is performed for <code>epoch_length</code> number of iterations, or until <code>engine.should_terminate == true</code>.</li><li>At the start of each iteration, <code>ITERATION_STARTED()</code> event is fired, and a batch of data is loaded.</li><li>The <code>process_function</code> is called on the loaded data batch.</li><li>At the end of each iteration, <code>ITERATION_COMPLETED()</code> event is fired.</li><li>At the end of each epoch, <code>EPOCH_COMPLETED()</code> event is fired.</li><li>At the end of all the epochs, <code>COMPLETED()</code> event is fired.</li></ol><p>If <code>engine.should_terminate</code> is set to <code>true</code> while running the engine, the engine will be terminated gracefully after the next completed iteration. This will subsequently trigger a <code>TERMINATE()</code> event to be fired followed by a <code>COMPLETED()</code> event.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jondeuce/Ignite.jl/blob/36313cb3703df9bcd4dc7d46aafe85efb3d7c973/src/Ignite.jl#L294-L320">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Ignite.terminate!-Tuple{Engine}" href="#Ignite.terminate!-Tuple{Engine}"><code>Ignite.terminate!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">terminate!(engine::Engine) -&gt; Engine
</code></pre><p>Terminate the engine by setting <code>engine.should_terminate = true</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jondeuce/Ignite.jl/blob/36313cb3703df9bcd4dc7d46aafe85efb3d7c973/src/Ignite.jl#L242-L246">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Ignite.throttle_filter" href="#Ignite.throttle_filter"><code>Ignite.throttle_filter</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">throttle_filter(throttle::Real) -&gt; Ignite.ThrottleFilter
throttle_filter(
    throttle::Real,
    last_fire::Real
) -&gt; Ignite.ThrottleFilter
</code></pre><p>Creates an event filter function for use in a <code>FilteredEvent</code> that returns <code>true</code> if at least <code>throttle</code> seconds has passed since it was last fired.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jondeuce/Ignite.jl/blob/36313cb3703df9bcd4dc7d46aafe85efb3d7c973/src/Ignite.jl#L514-L518">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Ignite.timeout_filter" href="#Ignite.timeout_filter"><code>Ignite.timeout_filter</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">timeout_filter(timeout::Real) -&gt; Ignite.TimeoutFilter
timeout_filter(
    timeout::Real,
    start_time::Real
) -&gt; Ignite.TimeoutFilter
</code></pre><p>Creates an event filter function for use in a <code>FilteredEvent</code> that returns <code>true</code> if at least <code>timeout</code> seconds has passed since the filter function was created.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jondeuce/Ignite.jl/blob/36313cb3703df9bcd4dc7d46aafe85efb3d7c973/src/Ignite.jl#L521-L525">source</a></section></article></article><nav class="docs-footer"><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.4.0 on <span class="colophon-date" title="Friday 26 April 2024 20:32">Friday 26 April 2024</span>. Using Julia version 1.6.7.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
